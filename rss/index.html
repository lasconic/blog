<rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title/><description/><link/>http://blog.lasconic.com/<generator>Ghost 0.5</generator><lastbuilddate>Mon, 15 Sep 2014 08:42:35 GMT</lastbuilddate><link href="http://blog.lasconic.com/rss/" rel="self" type="application/rss+xml"/><ttl>60</ttl><item><title/><description>Even if there are other mobile analytics services such as <a href="http://www.flurry.com/">Flurry</a>, Google Analytics (GA) is a popular (and free) way to get insights about marketing campaigns or app usage. In this article I will explain how to implement a simple tracking of displayed screens and events in a multiplatform Qt Quick app. 

<p><em>tl;dr</em> : A sample app is available on GitHub:  <a href="https://github.com/lasconic/GATutorial-QML">GATutorial-QML</a>. </p>

<h4 id="chooseyourway">Choose your way</h4>

<p>When integrating with third party services in a Qt Quick app, there are often two ways. </p>

<ul>
<li>The API way</li>
<li>The native SDK way</li>
</ul>

<p>For GA, there is a low level API called <a href="https://developers.google.com/analytics/devguides/collection/protocol/v1/">Measurement Protocol</a>. When a low level API, the developer is required to write more code. Here, we would need to cache data when the user is offline, get device ID ourself etc... The advantage of using the low level API is that it's easy to make a cross platform app. Measurement protocol relies only on HTTP.</p>

<p>GA also provides SDKs for Android and iOS. Both SDKs most likely implements the Measurement Protocol but they also provide several other features such as automatic screen views tracking (but a Qt Quick app cannot use it...), caching of hits when the device is offline, getting device ID for better tracking... To sum it up, The SDKs are doing all the heavy lifting for us. Google also provide an <a href="https://github.com/googleanalytics/google-analytics-plugin-for-unity">SDK for Unity</a> but no Qt Quick SDK. It's a curse any Qt developer will encounter a lot... (Hopefully not for long!)</p>

<p>If you are reading this, and know about a Google Analytics Qt project, even not from Google, <a href="http://twitter.com/lasconic">let me know</a>, I'd love to be wrong.</p>

<p>Our app is currently only available on iOS and Android. So, I chose the SDK way with a future fallback to Measurement Protocol if necessary.</p>

<h3 id="creatingtheappandasimpleapi">Creating the app and a simple API</h3>

<ul>
<li><p>Obviously a new property and tracking ID is necessary. You can get one on Google Analytics website.</p></li>
<li><p>Create a C++ class we can call from QML. The class has two Q_INVOKABLE functions <code>sendHit</code> and <code>sendEvent</code>. Both are just calling the native implementation that we will implement later. We also define a mother class for the native implementation <code>PlatformGoogleAnalytics</code>. Next paragraphs will describe the Android and iOS implementation. A default implementation using Measurement Protocol could be written too.</p></li>
<li><p>Expose the class to QML. In main.cpp, add </p></li>
</ul>

<pre><code class="language-cpp">GoogleAnalytics ganalytics;  
ganalytics.initTracker();  
engine.rootContext()-&gt;setContextProperty("gAnalytics", &amp;ganalytics);  
</code></pre>

<ul>
<li>in QML, to register an new screen view, just call</li>
</ul>

<pre><code class="language-javascript">gAnalytics.sendHit("myView")  
</code></pre>

<h3 id="androidglue">Android glue</h3>

<p>We have now a C++ class that we can call from QML. This class will now need to call Java and the Google Analytics SDK for Android.</p>

<h5 id="setupthegoogleanalyticssdkforandroid">Setup the Google Analytics SDK for Android</h5>

<ul>
<li><p>Create a directory in your project named <code>android_data</code>. </p></li>
<li><p>Add the following to your pro file </p></li>
</ul>

<pre><code class="language-javascript ">ANDROID_PACKAGE_SOURCE_DIR = $$PWD/android_data  
</code></pre>

<p>Qt Creator will merge the <code>android_data</code> directory with the one provided by Qt when building.</p>

<ul>
<li><p>Install the Google Analytics SDK for Android. You can find it in the maintenance tool of the SDK, in the extra section. Once installed, copy the <code>sdk/extras/google/google_play_services</code> directory to <code>android_data</code></p></li>
<li><p>create a project.properties file in android_data and add this line</p></li>
</ul>

<pre><code class="language-javascript">android.library.reference.1=google-play-services_lib  
</code></pre>

<ul>
<li>copy <code>android-support-v4.jar</code> from the android SDK to "android_data/libs"</li>
</ul>

<p>*Copy the <code>AndroidManifest.xml</code> file from Qt ( <code>android_armv7/src/android/java/AndroidManifest.xml</code>) to the <code>android_data</code> directory in the project</p>

<ul>
<li>Add the following the <code>AndroidManifest.xml</code>
In <code>&lt;activity&gt;</code>  </li>
</ul>

<pre><code class="language-markup">&lt;!-- Analytics --&gt;  
&lt;meta-data android:name="com.google.android.gms.version" android:value="@integer/google_play_services_version"/&gt;  
&lt;meta-data android:name="com.google.android.gms.analytics.globalConfigResource" android:resource="@xml/analytics_global_config"/&gt;  
&lt;!-- Analytics --&gt;  
</code></pre>

<p>in <code>&lt;application&gt;</code>  </p>

<pre><code class="language-markup">&lt;!-- Used for Google Play Store Campaign Measurement--&gt;;  
&lt;service android:name="com.google.android.gms.analytics.CampaignTrackingService"/&gt;  
&lt;receiver android:name="com.google.android.gms.analytics.CampaignTrackingReceiver" android:exported="true"&gt;  
     &lt;intent-filter&gt;
            &lt;action android:name="com.android.vending.INSTALL_REFERRER"/&gt;
     &lt;/intent-filter&gt;
&lt;/receiver&gt;  
</code></pre>

<p>This second part is not useful for tracking hits and events. It's used to track installation referrer. Read more about <a href="https://developers.google.com/analytics/devguides/collection/android/campaigns">Campaign Measurement</a></p>

<ul>
<li>Add analytics configuration files, as described in <code>AndroidManifest.xml</code>, in <code>android_data/res/xml</code>. I created one for the tracker and one with global parameters. The tracker one contains the tracker ID and it needs to be change to your own value.</li>
</ul>

<h5 id="javaside">Java side</h5>

<p>I wrote a short Java class, named QGoogleAnalytics in order to call two of the function provided by the SDK. The class is very simple and has two static public functions <code>sendHit</code> and <code>sendEvent</code>. Let's see how we can call them from C++ via JNI.</p>

<h5 id="cjni">C++ JNI</h5>

<p>Qt provides a very useful androidextras package to ease the writing of JNI.</p>

<ul>
<li>add the following to your pro file</li>
</ul>

<pre><code class="language-javascript">android {  
  QT += androidextras
}
</code></pre>

<ul>
<li>The code to call a static method is easy enough. The C++ class inherits from <code>PlatformGoogleAnalytics</code>.</li>
</ul>

<pre><code class="language-cpp">void AndroidGoogleAnalytics::sendHit(const QString &amp;screenName)  
{
  QAndroidJniObject jsScreenName = QAndroidJniObject::fromString(screenName);
  QAndroidJniObject::callStaticMethod&lt;void&gt;("com/lasconic/QGoogleAnalytics", "sendHit", "(Ljava/lang/String;)V", jsScreenName.object&lt;jstring&gt;());
}
</code></pre>

<h3 id="iosglue">iOS glue</h3>

<h4 id="setupthegoogleanalyticssdkforios">setup the Google Analytics SDK for iOS</h4>

<ul>
<li>Download the <a href="https://developers.google.com/analytics/devguides/collection/ios/resources">Google Analytics SDK for iOS v3</a></li>
<li>Unzip it</li>
<li>Create an <code>ios</code> directory in your project and copy the <code>include</code> directory in it</li>
<li>Create a <code>libs</code> directory and copy <code>libAdIdAccess.a</code> and            <code>libGoogleAnalyticsServices.a</code> in it</li>
<li>Modify the pro file to link these libraries and add framework dependencies.</li>
</ul>

<pre><code>ios {  
  QMAKE_LFLAGS += -framework CoreData -framework AdSupport -ObjC
  LIBS += -L$$PWD/ios/libs -lGoogleAnalyticsServices -lAdIdAccess -lsqlite3.0
}
</code></pre>

<h4 id="objectivecglue">Objective-C glue</h4>

<p>Objective-C can be mixed with C++ more easily than Java.</p>

<ul>
<li>To add an Objective-C class, modify the pro files</li>
</ul>

<pre><code class="language-javascript">OBJECTIVE_SOURCES += ios/iosanalytics.mm  
</code></pre>

<ul>
<li>also add a header file <code>iosanalytics.h</code></li>
<li>This class inherits <code>PlatformGoogleAnalytics</code> and call the SDK directly. You need to change the GA tracking ID in this class. Qt provides a convenient <code>toNSString()</code> method for <code>QString</code>.</li>
</ul>

<pre><code class="language-objectivec">void IosGoogleAnalytics::sendHit(const QString &amp;screenName) {  
    id&lt;GAITracker&gt; tracker = [[GAI sharedInstance] defaultTracker];
    // Send a screen view
    [tracker send:[[[GAIDictionaryBuilder createAppView] set:screenName.toNSString() forKey:kGAIScreenName] build]];
}
</code></pre>

<h4 id="conclusion">Conclusion</h4>

<p>This is a working and simple solution to integrate an iOS/Android Qt Quick app with Google Analytics. The code is available on GitHub: <a href="https://github.com/lasconic/GATutorial-QML">GATutorial-QML</a>. <br/>
The approach would be similar for any service which provide more value in native SDKs than in its crossplatform API, or even doesn't provide a crossplatform API.</p>

<p>Of course, it's a crude example. We could expose more <a href="https://developers.google.com/analytics/solutions/mobile-implementation-guide">Google Analytics features</a> to QML such as e-commerce tracking. Also, if we would want to support more platforms such as desktop ones or Windows Mobile, we would need to complete the fallback to Measurement Protocol.</p>

<p>Any comment? Find me on <a href="https://twitter.com/lasconic">twitter</a>.</p>]]&gt;</description><link/>http://blog.lasconic.com/how-to-use-google-analytics-in-a-qt-quick-app-for-androidios/<guid ispermalink="false">cfc1bb7a-ae6f-4387-b8e0-257452a6bbda</guid><creator/><pubdate>Thu, 11 Sep 2014 21:33:17 GMT</pubdate></item><item><title/><description>I considered several blog engines before starting this blog. First, I wanted an unexpensive and portable solution. Also, I wanted to avoid ads. I considered a self hosted <a href="http://wordpress.org/">Wordpress</a> but Wordpress has become a huge and complex pile of code. I'm using Markdown and git daily, so an engine based on them would be nice. I tested <a href="http://jekyllrb.com/">Jekyll</a> with <a href="https://github.com/poole">Hyde and Lanyon</a> and <a href="http://octopress.org/">Octopress</a> but Ruby... no thanks. I prefer Python, so I took a look to <a href="http://getpelican.org/">Pelican</a> but it feels less supported. So no good solution...

<p>I came accross <a href="https://ghost.org/download/">Ghost</a> which seems to gain momentum. Ghost lets me write in Markdown syntax and is based on Node.js. The default theme looks good enough and the community support seems ok. Still, I needed a database and a Node.js instance and so a server. I'd prefer to use Github Pages instead, so static HTML pages.</p>

<p><a href="https://github.com/axitkhurana/buster">Buster</a> to the rescue! Buster (Ghost, Buster, <a href="https://www.youtube.com/watch?v=I9bNyDjczVQ">got it</a>?) is a Python script to extract static content from a running Ghost instance. OK! Sound like a plan.</p>

<h2 id="installingghost">Installing Ghost</h2>

<p>I like to use nvm to manage the version of node I'm running. </p>

<pre><code>$ nvm install 0.10.30
$ nvm use 0.10.30
</code></pre>

<p>Then installing Ghost is easy enough. Download the zip from <a href="https://ghost.org/download/">Ghost download page</a>. Unzip it.</p>

<pre><code>$ cd ghost
$ npm install --production
</code></pre>

<p>And run it</p>

<pre><code>$ npm start
$ open 127.0.0.1:2368/ghost/
</code></pre>

<p>Configure Ghost in the browser.</p>

<h2 id="installingbuster">Installing Buster</h2>

<ul>
<li>Install <a href="http://pip.readthedocs.org/en/latest/installing.html">pip</a> if necessary. </li>
<li>Install <a href="https://github.com/axitkhurana/buster">Buster</a></li>
</ul>

<pre><code>$ pip install buster
</code></pre>

<h2 id="githubpages">GitHub pages</h2>

<ul>
<li>Create a new repository on GitHub</li>
<li><code>cd ghost</code></li>
<li><code>buster setup</code> and enter repository address</li>
<li><code>buster add-domain blog.example.com</code></li>
<li>Modify CNAME of DNS provider. 
<ul><li>Name: <code>blog</code> </li>
<li>Value: <code>blog.example.com.</code></li></ul></li>
</ul>

<h2 id="worflow">Worflow</h2>

<ul>
<li>Type article in the web interface of Ghost</li>
<li>When article is ready to be published </li>
</ul>

<pre><code>    $ buster generate --domain 127.0.0.1:2368
    $ buster preview
    $ buster deploy
</code></pre>

<h2 id="conclusion">Conclusion</h2>

<p>Since you are reading this conclusion, it's running. I still need to pick a theme and add a couple of features I'm missing.</p>

<ul>
<li>About page</li>
<li>Syntax hightlighter</li>
<li>Analytics</li>
<li>Comments, probably using Disqus</li>
<li>Eventually a search engine but with static websites is not always easy. I will check <a href="http://tapirgo.com/">Tapir</a> and <a href="http://www.tipue.com/search/">Tipue</a></li>
</ul>]]&gt;</description><link/>http://blog.lasconic.com/free-blog-hosting-using-ghost-buster-and-github-pages/<guid ispermalink="false">7d69aed9-af65-4228-a679-f97330cd5d75</guid><category/><category/><category/><category/><creator/><pubdate>Fri, 05 Sep 2014 08:39:54 GMT</pubdate></item><item><title/><description>I started several blogs along the years. My last attempt was probably around 2011. I hope this one will last longer! So what to expect from this blog?

<h2 id="programmingandsoftwarearchitecture">Programming and software architecture</h2>

<p>I'm currently the CTO at <a href="http://musescore.com/">MuseScore</a>. Primarly, MuseScore is a desktop application written in C++/Qt. I'm also in charge of the development of the MuseScore mobile apps for both iOS and Android. So I will probably write about Qt, QML, C++ and mobile development.</p>

<p>MuseScore is also two websites <a href="http://musescore.org/">http://musescore.org</a> and <a href="http://musescore.com/">http://musescore.com</a>. I'm not the webmaster of these two websites, but I did work on the development of both. The two websites are made with <a href="http://drupal.org/">Drupal</a> and PHP. In particular, I worked on the <a href="http://developers.musescore.com/">MuseScore.com API</a> and on the overall architecture of MuseScore.com running on AWS. So you might expect post about Drupal, PHP, Javascript, Java and AWS services.</p>

<p>I'm learning Python which is becoming my scripting language of choice. I also like to dabble in Node.js. And I'm planning to play with Go in the coming months.</p>

<h3 id="musicandmusicnotation">Music and Music Notation</h3>

<p>I'm a drummer and music lover. MuseScore is all about music notation. Expect some posts about music in general, music notation in particular, and maybe drumming.</p>

<h3 id="entrepeneurship">Entrepeneurship</h3>

<p>MuseScore is my first entrepeunarial endeavior. Putting in place a business model around a B2C free and open source software is challenging. I might post about this challenge and about the sheet music and music education market in general.</p>

<h3 id="englishmainly">English mainly</h3>

<p>Maybe you didn't figure it out yet but my mother tongue is French. I'm more confortable with English for technical topics, so I will mainly blog in English.</p>

<p>Happy reading!</p>]]&gt;</description><link/>http://blog.lasconic.com/first-post-what-to-expect/<guid ispermalink="false">ff607005-dd48-47c6-ae6b-7da805d0a670</guid><category/><category/><creator/><pubdate>Wed, 03 Sep 2014 10:04:38 GMT</pubdate></item></channel></rss>